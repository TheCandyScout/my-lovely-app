(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[831],{2068:(e,t,i)=>{Promise.resolve().then(i.bind(i,4269))},4269:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var r=i(5155),n=i(2115),l=i(6766),s=i(7431),o=i(3264);function a(){let[e,t]=(0,n.useState)(null),[i,a]=(0,n.useState)(!1),[d,c]=(0,n.useState)(null),[u,f]=(0,n.useState)(!1),[p,h]=(0,n.useState)(!1),[m,x]=(0,n.useState)(1200),g=(0,n.useRef)(null),w=(0,n.useRef)(null),v=(0,n.useRef)(null),y=(0,n.useRef)(null),b=(0,n.useRef)(null);function j(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];console.log("[AR DEBUG]",...t);let r=w.current;if(!r)return;let n=document.createElement("div");for(n.textContent=t.map(e=>e&&"object"==typeof e?JSON.stringify(e):String(e)).join(" "),r.appendChild(n);r.childElementCount>200;)r.removeChild(r.firstChild);r.scrollTop=r.scrollHeight}let C=(0,n.useCallback)(()=>{var e;y.current&&(y.current.end(),y.current=null),null!==b.current&&(cancelAnimationFrame(b.current),b.current=null),(null==(e=v.current)?void 0:e.parentElement)&&(v.current.parentElement.removeChild(v.current),v.current=null),h(!1)},[]);async function S(e,t){if(u){w.current.innerHTML="",j("launchAR()",e,t);try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(e=>e.stop());let i=await navigator.xr.requestSession("immersive-ar",{optionalFeatures:["dom-overlay","hit-test"],domOverlay:{root:g.current}});y.current=i,h(!0),i.addEventListener("end",()=>C());let r=document.createElement("canvas");Object.assign(r.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%"}),document.body.appendChild(r),v.current=r;let n=r.getContext("webgl2",{xrCompatible:!0,alpha:!0});await n.makeXRCompatible();let l=new XRWebGLLayer(i,n);i.updateRenderState({baseLayer:l});let a=new s.JeP({canvas:r,context:n,alpha:!0});a.setSize(window.innerWidth,window.innerHeight),a.xr.enabled=!0,a.xr.setReferenceSpaceType("local"),a.xr.setSession(i);let d=new o.Z58;d.add(new o.dth(0xffffff,4473924,1));let c=new o.ZyN(0xffffff,1.2);c.position.set(0,5,0),d.add(c);let u=new o.ubm(75,window.innerWidth/window.innerHeight,.1,1e3),f=await i.requestReferenceSpace("local"),p=await i.requestReferenceSpace("viewer");if(i.requestHitTestSource){let e=null;if("function"==typeof i.requestHitTestSource){let e=await i.requestHitTestSource({space:p});(null!=e?e:null)?j("✅ hit-test source ready"):j("⚠️ requestHitTestSource returned undefined")}else j("⚠️ hit-test not supported by this device");j("✅ hit-test source ready")}else j("⚠️ hit-test not supported by this device");let m=new o.YJl;d.add(m);let x=new o.eaF(new o.rKP(.1,.11,32),new o.V9B({color:0xffffff,side:o.$EB}));x.visible=!1,d.add(x);let w=new o.Tap;w.setCrossOrigin("anonymous"),w.load(e.src,e=>{let i=.01*t.widthCm,r=.01*t.heightCm;e.flipY=!1,e.colorSpace=o.er$;let n=e.image,l=n.naturalWidth/n.naturalHeight,s=i/r,a=i,d=r;l>s?d=i/l:a=r*l;let c=new o.eaF(new o.bdM(i,r),new o.V9B({color:0xffffff,side:o.$EB}));m.add(c);let u=new o.eaF(new o.bdM(a,d),new o.V9B({map:e,side:o.$EB}));u.position.z=.001,m.add(u)},void 0,e=>j("texture error",e));let S=!1,E=(e,t)=>{b.current=i.requestAnimationFrame(E);let r=i.renderState.baseLayer;n.bindFramebuffer(n.FRAMEBUFFER,r.framebuffer),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);let l=t.getViewerPose(f);if(!l){x.visible=!1;return}let s=l.views[0],o=r.getViewport(s);o&&(a.setViewport(o.x,o.y,o.width,o.height),u.matrix.fromArray(s.transform.matrix),u.projectionMatrix.fromArray(s.projectionMatrix),u.updateMatrixWorld(!0),a.render(d,u))};i.requestAnimationFrame(E),i.addEventListener("select",()=>{x.visible&&(S=!1,j("\uD83D\uDD04 select => will re-place at next hit-test"))})}catch(e){j("launchAR error",e),C()}}}function E(){t(null),C()}return(0,n.useEffect)(()=>()=>{C()},[C]),(0,n.useEffect)(()=>{let e=()=>x(window.innerWidth);return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,n.useEffect)(()=>{var e;(null==(e=navigator.xr)?void 0:e.isSessionSupported)&&navigator.xr.isSessionSupported("immersive-ar").then(e=>f(e)).catch(()=>f(!1))},[]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{style:{maxWidth:1400,margin:"0 auto",padding:"2rem"},children:[(0,r.jsx)("h1",{style:{textAlign:"center",fontWeight:300},children:"Print Collection"}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(300px,1fr))",gap:"2rem"},children:[{id:1,title:"Mountain Sunset",src:"/my-lovely-app/images/source.jpg",description:"35mm film scan of mountain landscape at sunset. Captured on Kodak Portra 400 with a Nikon F3.",sizes:[{size:'8x10"',price:45,widthCm:25.4,heightCm:20.32},{size:'11x14"',price:75,widthCm:35.56,heightCm:27.94},{size:'16x20"',price:120,widthCm:50.8,heightCm:40.64}],tags:["landscape","35mm","color"]}].map(e=>(0,r.jsxs)("div",{onClick:()=>{t(e),a(!1),c(null)},style:{cursor:"pointer",overflow:"hidden",borderRadius:8,boxShadow:"0 4px 8px rgba(0,0,0,0.1)",background:"white"},children:[(0,r.jsx)("div",{style:{position:"relative",height:240},children:(0,r.jsx)(l.default,{src:e.src,alt:e.title,fill:!0,style:{objectFit:"cover"}})}),(0,r.jsxs)("div",{style:{padding:"1rem",borderTop:"1px solid #eee"},children:[(0,r.jsx)("h3",{style:{margin:0},children:e.title}),(0,r.jsx)("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:e.tags.map(e=>(0,r.jsx)("span",{style:{background:"#f0f0f0",padding:"0.2rem 0.5rem",borderRadius:12,fontSize:12,color:"#666"},children:e},e))})]})]},e.id))}),e&&(0,r.jsx)("div",{onClick:E,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,r.jsxs)("div",{onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:8,display:m>768?"flex":"block",width:"90%",maxWidth:1200,maxHeight:"90vh",overflow:"hidden"},children:[(0,r.jsx)("button",{onClick:E,style:{position:"absolute",top:10,right:20,fontSize:24,background:"transparent",border:"none",cursor:"pointer",zIndex:1},children:"\xd7"}),(0,r.jsx)("div",{style:{flex:3,position:"relative",background:"#f5f5f5",height:m>768?"80vh":240},children:(0,r.jsx)(l.default,{src:e.src,alt:e.title,fill:!0,style:{objectFit:"contain"}})}),(0,r.jsxs)("div",{style:{flex:1,padding:"2rem",overflowY:"auto",borderLeft:m>768?"1px solid #eee":"none"},children:[(0,r.jsx)("h2",{style:{marginTop:0},children:e.title}),(0,r.jsx)("button",{onClick:function(){a(e=>!e)},style:{marginBottom:"1rem"},children:i?"Hide Details":"Show Details"}),i&&(0,r.jsx)("p",{children:e.description}),(0,r.jsx)("h3",{children:"Available Sizes"}),(0,r.jsx)("ul",{style:{listStyle:"none",padding:0},children:e.sizes.map(t=>(0,r.jsxs)("li",{style:{marginBottom:"1rem"},children:[(0,r.jsxs)("label",{style:{cursor:"pointer"},children:[(0,r.jsx)("input",{type:"radio",name:"size",checked:d===t,onChange:()=>{c(t)}})," ",t.size," — $",t.price]}),u&&(0,r.jsx)("button",{onClick:()=>S(e,t),disabled:p,style:{marginLeft:8},children:p?"AR Active":"View in Your Space"})]},t.size))})]})]})}),(0,r.jsx)("div",{ref:g,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1100,pointerEvents:"none"}}),(0,r.jsx)("div",{ref:w,style:{position:"fixed",bottom:0,left:0,width:"100%",maxHeight:"200px",overflowY:"auto",background:"rgba(0,0,0,0.6)",color:"#0f0",fontSize:"11px",fontFamily:"monospace",padding:"4px 8px",zIndex:1200,pointerEvents:"none"}})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[367,212,766,441,684,358],()=>t(2068)),_N_E=e.O()}]);