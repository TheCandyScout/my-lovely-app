(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[690],{435:(e,i,a)=>{Promise.resolve().then(a.bind(a,1612))},1612:(e,i,a)=>{"use strict";a.r(i),a.d(i,{default:()=>p});var n=a(5155),t=a(2115),l=a(7579),s=a(495),r=a(5964),o=a.n(r),h=a(8672),d=a.n(h);let c=e=>{let[i,a]=(0,t.useState)(null),[n,l]=(0,t.useState)(null),[s,r]=(0,t.useState)(!0),[o,h]=(0,t.useState)(null);return(0,t.useEffect)(()=>{if(!e){h("No URL"),r(!1);return}let i=new Image;return i.crossOrigin="anonymous",i.onload=()=>{a(i),l({width:i.naturalWidth,height:i.naturalHeight}),r(!1)},i.onerror=()=>{h("Failed to load"),r(!1)},i.src=e,()=>{i.onload=null,i.onerror=null}},[e]),{image:i,dimensions:n,loading:s,error:o}},g=(e,i,a,n,t,l)=>{var s,r;if(!e)return null;let o=l||.5,{width:h,height:d}=n,{width:c,height:g}=t,m=null!=(s=null==i?void 0:i.width)?s:e.width,u=null!=(r=null==i?void 0:i.height)?r:e.height,f=a.x/(h/m),p=a.y/(d/u),_=c/o,w=g/o,x=Math.max(0,Math.min(f-_/2,m-_)),v=Math.max(0,Math.min(p-w/2,u-w)),S=o,j=o;if(i&&e!==i){let i=e.width/m,a=e.height/u;x*=i,v*=a,S=o/i,j=o/a}return{x:x,y:v,scaleX:S,scaleY:j,sourceWidth:_,sourceHeight:w,centerX:f,centerY:p}},m=t.memo(e=>{let{image:i,params:a,width:t,height:s}=e;return(0,n.jsx)(l.BI,{width:t,height:s,style:{width:"100%",height:"100%"},children:(0,n.jsx)(l.Wd,{children:(0,n.jsx)(l.rw,{x:0,y:0,width:t,height:s,fillPatternImage:i,fillPatternScale:{x:a.scaleX,y:a.scaleY},fillPatternOffset:{x:a.x,y:a.y}})})})},(e,i)=>e.image===i.image&&e.params.x===i.params.x&&e.params.y===i.params.y&&e.params.scaleX===i.params.scaleX&&e.params.scaleY===i.params.scaleY);m.displayName="MagnifiedViewContent";let u=e=>{let{image:i,referenceImage:a,magnifierPosition:l,stageDimensions:s,magDimensions:r,zoomScale:o,loading:h}=e,c=(0,t.useMemo)(()=>i?g(i,a,l,s,r,o):null,[i,a,l,s,r,o]);return!h&&i&&c?(0,n.jsx)(m,{image:i,params:c,width:r.width,height:r.height}):(0,n.jsx)("div",{className:d().loadingOverlay,children:(0,n.jsx)("div",{className:d().loaderSpinner})})};u.displayName="MagnifiedView";let f=t.memo(e=>{let{image:i,stageDimensions:a,showRectangle:t,magnifierPosition:s,lensSize:r,onMouseMove:o,onTouchMove:h,onClick:d}=e;return(0,n.jsx)(l.BI,{width:a.width,height:a.height,onClick:d,onTouchStart:d,onMouseMove:o,onTouchMove:h,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"8px"},children:(0,n.jsxs)(l.Wd,{children:[(0,n.jsx)(l._V,{image:i,x:0,y:0,width:a.width,height:a.height}),t&&(0,n.jsx)(l.rw,{x:s.x-r.width/2,y:s.y-r.height/2,width:r.width,height:r.height,stroke:"red",strokeWidth:2})]})})});function p(){let{image:e,dimensions:i,loading:a}=c("/my-lovely-app/images/hq.jpg"),{image:l,loading:r}=c("/my-lovely-app/images/lq.jpg"),[h,g]=(0,t.useState)({x:0,y:0}),[m,p]=(0,t.useState)(!1),[_,w]=(0,t.useState)(!1),[x,v]=(0,t.useState)({width:400,height:300}),S=(0,t.useMemo)(()=>({width:400,height:400}),[]),j=(0,t.useRef)(null),y=(0,t.useRef)(null);(0,t.useEffect)(()=>{e&&!a&&i&&g({x:x.width/2,y:x.height/2})},[e,a,i,x]);let N=(0,t.useCallback)(()=>{if(!j.current||!i)return;let e=j.current.offsetWidth,a=Math.floor(e*i.height/i.width);v({width:e,height:a})},[i]);(0,t.useEffect)(()=>{if(e&&!a&&i&&j.current){let e=new ResizeObserver(o()(N,150));return y.current=e,e.observe(j.current),N(),()=>e.disconnect()}},[e,a,i,N]);let M=(0,t.useCallback)(e=>{var i;if(!m)return;let a=null==(i=e.target.getStage())?void 0:i.getPointerPosition();a&&g(a)},[m]),P=(0,t.useCallback)(e=>{var i;if(!m)return;e.evt.preventDefault();let a=null==(i=e.target.getStage())?void 0:i.getPointerPosition();a&&g(a)},[m]),b=(0,t.useCallback)(e=>{var i;let a=null==(i=e.target.getStage())?void 0:i.getPointerPosition();a&&(p(e=>!e),w(!0),g(a))},[]),C=(0,t.useMemo)(()=>{if(!e)return{width:50,height:50};let i=S.width/.5,a=S.height/.5;return{width:Math.max(50,i*(x.width/e.width)),height:Math.max(50,a*(x.height/e.height))}},[e,S,.5,x]);return(0,n.jsxs)("article",{className:d().page,children:[(0,n.jsx)("header",{className:d().header,children:(0,n.jsx)("h1",{className:d().title,children:"Comparing Cropped Image Quality"})}),(0,n.jsxs)("div",{className:d().views,children:[(0,n.jsxs)("div",{className:"".concat(d().panel," ").concat(d().mainPanel),children:[(0,n.jsxs)("div",{ref:j,className:"".concat(d().mainViewContainer),children:[(a||!e)&&(0,n.jsx)("div",{className:d().loadingOverlay,children:(0,n.jsx)("div",{className:d().loaderSpinner})}),(0,n.jsx)("div",{className:"".concat(d().stageWrapper," ").concat(!a&&e?d().loaded:""),children:e&&(0,n.jsx)(f,{image:e,stageDimensions:x,showRectangle:_,magnifierPosition:h,lensSize:C,onMouseMove:M,onTouchMove:P,onClick:b})})]}),(0,n.jsx)("p",{className:d().viewInfo,children:"Tap/click to toggle the magnifier"})]}),(0,n.jsxs)("div",{className:"".concat(d().panel," ").concat(d().sidePanel),children:[(0,n.jsx)("div",{className:d().sideViewContainer,children:(m?a:a||r)?(0,n.jsx)("div",{className:d().loadingOverlay,children:(0,n.jsx)("div",{className:d().loaderSpinner})}):m?(0,n.jsx)(u,{image:e,referenceImage:e,magnifierPosition:h,stageDimensions:x,magDimensions:S,zoomScale:.5,loading:a}):(0,n.jsx)(s.EW,{position:50,style:{width:"100%",height:"100%",borderRadius:"8px"},itemOne:(0,n.jsx)(u,{image:e,referenceImage:e,magnifierPosition:h,stageDimensions:x,magDimensions:S,zoomScale:.5,loading:a}),itemTwo:(0,n.jsx)(u,{image:l,referenceImage:e,magnifierPosition:h,stageDimensions:x,magDimensions:S,zoomScale:.5,loading:r})})}),(0,n.jsx)("p",{className:d().viewInfo,children:m?"Magnifier active":"Slide to compare two magnifications"})]})]}),(0,n.jsxs)("section",{className:d().observations,children:[(0,n.jsx)("h2",{children:"Observations"}),(0,n.jsx)("p",{children:"Use tap/click to toggle the magnifier, or slide to compare."})]})]})}f.displayName="MainImageView"},8672:e=>{e.exports={page:"filmScanning_page__pWXuD",header:"filmScanning_header__XQxTD",title:"filmScanning_title__q7_dX",subtitle:"filmScanning_subtitle__9aXQp",views:"filmScanning_views__SY0Ar",panel:"filmScanning_panel__q6HsN",mainPanel:"filmScanning_mainPanel__1JBPD",sidePanel:"filmScanning_sidePanel__lblpd",sideViewContainer:"filmScanning_sideViewContainer__kIV54",mainViewContainer:"filmScanning_mainViewContainer__ycSh7",loadingOverlay:"filmScanning_loadingOverlay__IvzoT",loaderSpinner:"filmScanning_loaderSpinner__CKqeX",spin:"filmScanning_spin__JJv4M",stageWrapper:"filmScanning_stageWrapper__smHiE",loaded:"filmScanning_loaded__3bkTa",viewInfo:"filmScanning_viewInfo__ChZ1a",observations:"filmScanning_observations__AxEXd"}}},e=>{var i=i=>e(e.s=i);e.O(0,[131,413,218,441,684,358],()=>i(435)),_N_E=e.O()}]);