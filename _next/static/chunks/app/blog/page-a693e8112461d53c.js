(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[831],{2068:(e,t,n)=>{Promise.resolve().then(n.bind(n,4269))},4269:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var i=n(5155),r=n(2115),l=n(6766),o=n(7431),a=n(3264);function s(){let[e,t]=(0,r.useState)(null),[n,s]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),[p,u]=(0,r.useState)(!1),[f,h]=(0,r.useState)(!1),[m,x]=(0,r.useState)(1200),g=(0,r.useRef)(null),w=(0,r.useRef)(null),v=(0,r.useRef)(null),y=(0,r.useRef)(null),b=(0,r.useRef)(null);function j(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("[AR DEBUG]",...t);let i=w.current;if(!i)return;let r=document.createElement("div");for(r.textContent=t.map(e=>e&&"object"==typeof e?JSON.stringify(e):String(e)).join(" "),i.appendChild(r);i.childElementCount>200;)i.removeChild(i.firstChild);i.scrollTop=i.scrollHeight}let C=(0,r.useCallback)(()=>{var e;y.current&&(y.current.end(),y.current=null),null!==b.current&&(cancelAnimationFrame(b.current),b.current=null),(null==(e=v.current)?void 0:e.parentElement)&&(v.current.parentElement.removeChild(v.current),v.current=null),h(!1)},[]);async function E(e,t){if(!p)return;w.current.innerHTML="",j("\uD83D\uDE80 launchAR",e,t),(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(e=>e.stop());let n=await navigator.xr.requestSession("immersive-ar",{optionalFeatures:["dom-overlay","hit-test","plane-detection","anchors","depth-sensing","light-estimation"],domOverlay:{root:g.current}});y.current=n,h(!0),n.addEventListener("end",C);let i=document.createElement("canvas");Object.assign(i.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",zIndex:1001}),document.body.appendChild(i),v.current=i;let r=i.getContext("webgl2",{xrCompatible:!0,alpha:!0,antialias:!0,depth:!0});await r.makeXRCompatible();let l=new XRWebGLLayer(n,r,{framebufferScaleFactor:1});n.updateRenderState({baseLayer:l});let s=new o.JeP({canvas:i,context:r,alpha:!0});s.setSize(window.innerWidth,window.innerHeight),s.xr.enabled=!0,s.xr.setReferenceSpaceType("local"),s.xr.setSession(n);let d=new a.Z58;d.add(new a.dth(0xffffff,4473924,1));let c=new a.ZyN(0xffffff,1.2);c.position.set(0,5,0),d.add(c);let u=new a.ubm(75,window.innerWidth/window.innerHeight,.1,1e3),f=await n.requestReferenceSpace("local"),m=new Map,x=new a.V9B({color:65280,side:a.$EB,transparent:!0,opacity:.2}),E=new a.V9B({color:0xff0000,side:a.$EB,transparent:!0,opacity:.2});n.addEventListener("planeadded",e=>{for(let t of e.planes){let e=t.polygon;j("➕ planeadded id=".concat(t.planeId," pts=").concat(e.length));let n=[];for(let t=2;t<e.length;t++)n.push(e[0].x,e[0].y,e[0].z,e[t-1].x,e[t-1].y,e[t-1].z,e[t].x,e[t].y,e[t].z);let i=new a.LoY;i.setAttribute("position",new a.qtW(n,3));let r=e.length>=4?x:E,l=new a.eaF(i,r);l.matrixAutoUpdate=!1,d.add(l),m.set(t.planeId,l)}}),n.addEventListener("planeupdated",e=>{for(let t of e.planes){let e=m.get(t.planeId);if(!e)continue;let n=t.polygon;j("\uD83D\uDD04 planeupdated id=".concat(t.planeId," pts=").concat(n.length));let i=[];for(let e=2;e<n.length;e++)i.push(n[0].x,n[0].y,n[0].z,n[e-1].x,n[e-1].y,n[e-1].z,n[e].x,n[e].y,n[e].z);e.geometry.setAttribute("position",new a.qtW(i,3)),e.material=n.length>=4?x:E}}),n.addEventListener("planeremoved",e=>{for(let t of e.planes){let e=m.get(t.planeId);e&&(j("➖ planeremoved id=".concat(t.planeId)),d.remove(e),m.delete(t.planeId))}});let S=new a.eaF(new a.rKP(.1,.15,32),new a.V9B({color:0xffffff,side:a.$EB}));S.visible=!1,d.add(S);let z=new a.YJl;z.visible=!1,d.add(z),new a.Tap().setCrossOrigin("anonymous").load(e.src,e=>{let n=.01*t.widthCm,i=.01*t.heightCm;e.flipY=!1,e.colorSpace=a.er$;let r=e.image,l=r.naturalWidth/r.naturalHeight,o=n/i,s=n,d=i;l>o?d=n/l:s=i*l,z.add(new a.eaF(new a.bdM(n,i),new a.V9B({color:0xffffff,side:a.$EB})));let c=new a.eaF(new a.bdM(s,d),new a.V9B({map:e,side:a.$EB}));c.position.z=.001,z.add(c)},void 0,e=>j("❌ texture load error",e));let k=null,F=new a.tBo,R=new a.kn4,B=(e,t)=>{b.current=n.requestAnimationFrame(B),k=t;let i=n.renderState.baseLayer;r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);let l=t.getViewerPose(f);if(!l)return;let o=l.views[0],c=i.getViewport(o);if(!c)return;s.setViewport(c.x,c.y,c.width,c.height),u.matrix.fromArray(o.transform.matrix),u.projectionMatrix.fromArray(o.projectionMatrix),u.updateMatrixWorld(!0);let p=t.worldInformation;if(null==p?void 0:p.detectedPlanes)for(let e of p.detectedPlanes){let n=m.get(e.planeId);if(!n)continue;let i=t.getPose(e.planeSpace,f);i&&(R.fromArray(i.transform.matrix),n.matrix.copy(R))}d.updateMatrixWorld(!0),F.ray.origin.setFromMatrixPosition(u.matrixWorld),u.getWorldDirection(F.ray.direction);let h=F.intersectObjects(Array.from(m.values()),!1);if(h.length>0){let e=h[0];S.visible=!0,S.position.copy(e.point),S.quaternion.setFromUnitVectors(new a.Pq0(0,0,1),e.face.normal),j("\uD83D\uDD0D ray hit plane at",e.point)}else S.visible=!1;s.render(d,u)};n.requestAnimationFrame(B),n.addEventListener("select",()=>{if(!k||!S.visible)return void j("⚠️ No plane under reticle – cannot place");z.position.copy(S.position),z.quaternion.copy(S.quaternion),z.visible=!0,j("\uD83D\uDCCC Placed on wall at",S.position)});let A=document.createElement("button");A.textContent="Reset",Object.assign(A.style,{position:"absolute",bottom:"20px",left:"50%",transform:"translateX(-50%)",padding:"8px 16px",background:"white",pointerEvents:"auto",zIndex:1002}),A.onclick=()=>{z.visible=!1,j("♻️ Reset – select a wall to place")},g.current.appendChild(A),n.addEventListener("end",()=>A.remove())}function S(){t(null),C()}return(0,r.useEffect)(()=>()=>{C()},[C]),(0,r.useEffect)(()=>{let e=()=>x(window.innerWidth);return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{var e;(null==(e=navigator.xr)?void 0:e.isSessionSupported)&&navigator.xr.isSessionSupported("immersive-ar").then(e=>u(e)).catch(()=>u(!1))},[]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{style:{maxWidth:1400,margin:"0 auto",padding:"2rem"},children:[(0,i.jsx)("h1",{style:{textAlign:"center",fontWeight:300},children:"Print Collection"}),(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(300px,1fr))",gap:"2rem"},children:[{id:1,title:"Mountain Sunset",src:"/my-lovely-app/images/source.jpg",description:"35mm film scan of mountain landscape at sunset. Captured on Kodak Portra 400 with a Nikon F3.",sizes:[{size:'8x10"',price:45,widthCm:25.4,heightCm:20.32},{size:'11x14"',price:75,widthCm:35.56,heightCm:27.94},{size:'16x20"',price:120,widthCm:50.8,heightCm:40.64}],tags:["landscape","35mm","color"]}].map(e=>(0,i.jsxs)("div",{onClick:()=>{t(e),s(!1),c(null)},style:{cursor:"pointer",overflow:"hidden",borderRadius:8,boxShadow:"0 4px 8px rgba(0,0,0,0.1)",background:"white"},children:[(0,i.jsx)("div",{style:{position:"relative",height:240},children:(0,i.jsx)(l.default,{src:e.src,alt:e.title,fill:!0,style:{objectFit:"cover"}})}),(0,i.jsxs)("div",{style:{padding:"1rem",borderTop:"1px solid #eee"},children:[(0,i.jsx)("h3",{style:{margin:0},children:e.title}),(0,i.jsx)("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:e.tags.map(e=>(0,i.jsx)("span",{style:{background:"#f0f0f0",padding:"0.2rem 0.5rem",borderRadius:12,fontSize:12,color:"#666"},children:e},e))})]})]},e.id))}),e&&(0,i.jsx)("div",{onClick:S,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,i.jsxs)("div",{onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:8,display:m>768?"flex":"block",width:"90%",maxWidth:1200,maxHeight:"90vh",overflow:"hidden"},children:[(0,i.jsx)("button",{onClick:S,style:{position:"absolute",top:10,right:20,fontSize:24,background:"transparent",border:"none",cursor:"pointer",zIndex:1},children:"\xd7"}),(0,i.jsx)("div",{style:{flex:3,position:"relative",background:"#f5f5f5",height:m>768?"80vh":240},children:(0,i.jsx)(l.default,{src:e.src,alt:e.title,fill:!0,style:{objectFit:"contain"}})}),(0,i.jsxs)("div",{style:{flex:1,padding:"2rem",overflowY:"auto",borderLeft:m>768?"1px solid #eee":"none"},children:[(0,i.jsx)("h2",{style:{marginTop:0},children:e.title}),(0,i.jsx)("button",{onClick:function(){s(e=>!e)},style:{marginBottom:"1rem"},children:n?"Hide Details":"Show Details"}),n&&(0,i.jsx)("p",{children:e.description}),(0,i.jsx)("h3",{children:"Available Sizes"}),(0,i.jsx)("ul",{style:{listStyle:"none",padding:0},children:e.sizes.map(t=>(0,i.jsxs)("li",{style:{marginBottom:"1rem"},children:[(0,i.jsxs)("label",{style:{cursor:"pointer"},children:[(0,i.jsx)("input",{type:"radio",name:"size",checked:d===t,onChange:()=>{c(t)}})," ",t.size," — $",t.price]}),p&&(0,i.jsx)("button",{onClick:()=>E(e,t),disabled:f,style:{marginLeft:8},children:f?"AR Active":"View in Your Space"})]},t.size))})]})]})}),(0,i.jsx)("div",{ref:g,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1100,pointerEvents:"none"}}),(0,i.jsx)("div",{ref:w,style:{position:"fixed",bottom:0,left:0,width:"100%",maxHeight:"200px",overflowY:"auto",background:"rgba(0,0,0,0.6)",color:"#0f0",fontSize:"11px",fontFamily:"monospace",padding:"4px 8px",zIndex:1200,pointerEvents:"none"}})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[367,212,766,441,684,358],()=>t(2068)),_N_E=e.O()}]);